# A-la-carte istio ingress gateway.
# Must be installed in a separate namespace, to minimize access to secrets.

## @section Global parameters
##

## Global Docker image parameters
## Please, note that this will override the image parameters, including dependencies, configured to use the global value
## Current available global Docker image parameters: imageRegistry, imagePullSecrets and storageClass
##
global:
  ## @param global.imageRegistry Global Docker image registry
  ## @param global.imagePullSecrets Global Docker registry secret names as an array
  ## @param global.storageClass Global StorageClass for Persistent Volume(s)
  ##
  imageRegistry: ""
  ## E.g.
  ## imagePullSecrets:
  ##   - myRegistryKeySecretName
  ##
  imagePullSecrets: []
  storageClass: ""

  # set the default set of namespaces to which services, service entries, virtual services, destination
  # rules should be exported to. Currently only one value can be provided in this list. This value
  # should be one of the following two options:
  # * implies these objects are visible to all namespaces, enabling any sidecar to talk to any other sidecar.
  # . implies these objects are visible to only to sidecars in the same namespace, or if imported as a Sidecar.egress.host
  defaultConfigVisibilitySettings: []

  # To output all istio components logs in json format by adding --log_as_json argument to each container argument
  logAsJson: false

  # Specify pod scheduling arch(amd64, ppc64le, s390x, arm64) and weight as follows:
  #   0 - Never scheduled
  #   1 - Least preferred
  #   2 - No preference
  #   3 - Most preferred
  arch:
    amd64: 2
    s390x: 2
    ppc64le: 2
    arm64: 2

  # Comma-separated minimum per-scope logging level of messages to output, in the form of <scope>:<level>,<scope>:<level>
  # The control plane has different scopes depending on component, but can configure default log level across all components
  # If empty, default scope and level will be used as configured in code
  logging:
    level: "default:info"
    ## @param logging.logAsJson To output all istio components logs in json format by adding --log_as_json argument to each container argument
    ##
    logAsJson: false

  # Kubernetes >=v1.11.0 will create two PriorityClass, including system-cluster-critical and
  # system-node-critical, it is better to configure this in order to make sure your Istio pods
  # will not be killed because of low priority class.
  # Refer to https://kubernetes.io/docs/concepts/configuration/pod-priority-preemption/#priorityclass
  # for more detail.
  priorityClassName: ""

  proxy:
    # Per Component log level for proxy, applies to gateways and sidecars. If a component level is
    # not set, then the global "logLevel" will be used.
    componentLogLevel: "misc:error"

    # If set, newly injected sidecars will have core dumps enabled.
    enableCoreDump: false

    # Log level for proxy, applies to gateways and sidecars.
    # Expected values are: trace|debug|info|warning|error|critical|off
    logLevel: warning

  ##############################################################################################
  # The following values are found in other charts. To effectively modify these values, make   #
  # make sure they are consistent across your Istio helm charts                                #
  ##############################################################################################

  # The customized CA address to retrieve certificates for the pods in the cluster.
  # CSR clients such as the Istio Agent and ingress gateways can use this to specify the CA endpoint.
  caAddress: ""

  # Used to locate istiod.
  istioNamespace: istio-system

  # Configure the policy for validating JWT.
  # Currently, two options are supported: "third-party-jwt" and "first-party-jwt".
  jwtPolicy: "third-party-jwt"

  # Mesh ID means Mesh Identifier. It should be unique within the scope where
  # meshes will interact with each other, but it is not required to be
  # globally/universally unique. For example, if any of the following are true,
  # then two meshes must have different Mesh IDs:
  # - Meshes will have their telemetry aggregated in one place
  # - Meshes will be federated together
  # - Policy will be written referencing one mesh from the other
  #
  # If an administrator expects that any of these conditions may become true in
  # the future, they should ensure their meshes have different Mesh IDs
  # assigned.
  #
  # Within a multicluster mesh, each cluster must be (manually or auto)
  # configured to have the same Mesh ID value. If an existing cluster 'joins' a
  # multicluster mesh, it will need to be migrated to the new mesh ID. Details
  # of migration TBD, and it may be a disruptive operation to change the Mesh
  # ID post-install.
  #
  # If the mesh admin does not specify a value, Istio will use the value of the
  # mesh's Trust Domain. The best practice is to select a proper Trust Domain
  # value.
  meshID: ""

  # Use the user-specified, secret volume mounted key and certs for Pilot and workloads.
  mountMtlsCerts: false

  multiCluster:
    # Set to true to connect two kubernetes clusters via their respective
    # ingressgateway services when pods in each cluster cannot directly
    # talk to one another. All clusters should be using Istio mTLS and must
    # have a shared root CA for this model to work.
    enabled: false
    # Should be set to the name of the cluster this installation will run in. This is required for sidecar injection
    # to properly label proxies
    clusterName: ""
    # The suffix for global service names
    globalDomainSuffix: "global"
    # Enable envoy filter to translate `globalDomainSuffix` to cluster local suffix for cross cluster communication
    includeEnvoyFilter: true

  # Network defines the network this cluster belong to. This name
  # corresponds to the networks in the map of mesh networks.
  network: ""

  # Configure the certificate provider for control plane communication.
  # Currently, two providers are supported: "kubernetes" and "istiod".
  # As some platforms may not have kubernetes signing APIs,
  # Istiod is the default
  pilotCertProvider: istiod

  sds:
    # The JWT token for SDS and the aud field of such JWT. See RFC 7519, section 4.1.3.
    # When a CSR is sent from Citadel Agent to the CA (e.g. Citadel), this aud is to make sure the
    # JWT is intended for the CA.
    token:
      aud: istio-ca

  sts:
    # The service port used by Security Token Service (STS) server to handle token exchange requests.
    # Setting this port to a non-zero value enables STS server.
    servicePort: 0
  # whether to use autoscaling/v2 template for HPA settings
  # for internal usage only, not to be configured by users.
  autoscalingv2API: true

## @section Common parameters

## @param kubeVersion Override Kubernetes version
##
kubeVersion: ""
## @param nameOverride String to partially override st-common.names.fullname
##
nameOverride: ""
## @param namespaceOverride String to fully override st-common.names.namespace
##
namespaceOverride: ""
## @param fullnameOverride String to fully override st-common.names.fullname
##
fullnameOverride: ""
## @param commonLabels Labels to add to all deployed objects
##
commonLabels: {}
## @param commonAnnotations Annotations to add to all deployed objects
##
commonAnnotations: {}
## @param clusterDomain Kubernetes cluster domain name
## CAUTION: It is important to ensure that all Istio helm charts specify the same clusterDomain value
## cluster domain. Default value is "cluster.local".
##
clusterDomain: cluster.local
## @param extraDeploy Array of extra objects to deploy with the release
##
extraDeploy: []
## Enable diagnostic mode in the deployment
##
diagnosticMode:
  ## @param diagnosticMode.enabled Enable diagnostic mode (all probes will be disabled and the command will be overridden)
  ##
  enabled: false
  ## @param diagnosticMode.command Command to override all containers in the deployment
  ##
  command:
    - sleep
  ## @param diagnosticMode.args Args to override all containers in the deployment
  ##
  args:
    - infinity

## @param istioNamespace Used to locate istiod.
##
istioNamespace: "istio-system"

gatewayClassName: istio

## @param logLevel Set up Istio Gateway log level
##
logLevel: 2
## @param replicaCount Number of Istio Gateway replicas
##
replicaCount: 1
# Revision is set as 'version' label and part of the resource names when installing multiple control planes.
revision: ""
# For Helm compatibility.
ownerName: ""

operator:
  component: "IngressGateway"

meshConfig:
  enablePrometheusMerge: true

  # The trust domain corresponds to the trust root of a system
  # Refer to https://github.com/spiffe/spiffe/blob/master/standards/SPIFFE-ID.md#21-trust-domain
  trustDomain: "cluster.local"

  defaultConfig:
    proxyMetadata: {}
    tracing:
    #      tlsSettings:
    #        mode: DISABLE # DISABLE, SIMPLE, MUTUAL, ISTIO_MUTUAL
    #        clientCertificate: # example: /etc/istio/tracer/cert-chain.pem
    #        privateKey:        # example: /etc/istio/tracer/key.pem
    #        caCertificates:    # example: /etc/istio/tracer/root-cert.pem
    #        sni:               # example: tracer.somedomain
    #        subjectAltNames: []
    # - tracer.somedomain

## Istio Gateway Pod Disruption Budget configuration
## ref: https://kubernetes.io/docs/tasks/run-application/configure-pdb/
##
pdb:
  ## @param pdb.create Enable/disable a Pod Disruption Budget creation for Istio Gateway pods
  ##
  create: true
  ## @param pdb.minAvailable Minimum number/percentage of Istio Gateway pods that must still be available after the eviction
  ##
  minAvailable: 1
  ## @param pdb.maxUnavailable Maximum number/percentage of Istio Gateway pods that can be unavailable after the eviction
  ##
  maxUnavailable: ""
## Enable HorizontalPodAutoscaler for gateway pods
## ref: https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/
## @param autoscaling.enabled Whether enable horizontal pod autoscaler
## @param autoscaling.minReplicas Configure a minimum amount of pods
## @param autoscaling.maxReplicas Configure a maximum amount of pods
## @param autoscaling.targetCPU Define the CPU target to trigger the scaling actions (utilization percentage)
## @param autoscaling.targetMemory Define the memory target to trigger the scaling actions (utilization percentage)
##
autoscaling:
  enabled: true
  minReplicas: 1
  maxReplicas: 3
  targetCPU: 80
  targetMemory: 80

## @section Other Parameters
##

## Role Based Access Configuration
## Ref: https://kubernetes.io/docs/admin/authorization/rbac/
##
rbac:
  ## @param rbac.create Specify whether RBAC resources should be created and used
  ##
  create: true
  ## @param rbac.rules Custom RBAC rules
  ## Example:
  ## rules:
  ##   - apiGroups:
  ##       - ""
  ##     resources:
  ##       - pods
  ##     verbs:
  ##       - get
  ##       - list
  ##
  rules: []

## Specifies whether a ServiceAccount should be created
##
serviceAccount:
  ## @param serviceAccount.create Enable the creation of a ServiceAccount for Istio Gateway pods
  ##
  create: true
  ## @param serviceAccount.name Name of the created ServiceAccount
  ## If not set and create is true, a name is generated using the fullname template
  ##
  name: ""
  ## @param serviceAccount.automountServiceAccountToken Auto-mount the service account token in the pod
  ##
  automountServiceAccountToken: true
  ## @param serviceAccount.annotations Additional custom annotations for the ServiceAccount
  ##
  annotations: {}

## Istio Gateway Prometheus exporter parameters
##
metrics:
  ## @param metrics.enabled Start a side-car prometheus exporter
  ##
  enabled: true
  ## @param metrics.annotations [object] Annotations for the Exporter pod
  ##
  annotations:
    prometheus.io/port: "15090"
    prometheus.io/scrape: "true"
    prometheus.io/path: "/stats/prometheus"
  ## Prometheus Service Monitor
  ## ref: https://github.com/coreos/prometheus-operator
  ##
  serviceMonitor:
    ## @param metrics.serviceMonitor.enabled Create ServiceMonitor Resource for scraping metrics using PrometheusOperator
    ##
    enabled: false
    ## @param metrics.serviceMonitor.namespace Namespace which Prometheus is running in
    ##
    namespace: ""
    ## @param metrics.serviceMonitor.jobLabel The name of the label on the target service to use as the job name in prometheus.
    ##
    jobLabel: ""
    ## @param metrics.serviceMonitor.interval Interval at which metrics should be scraped
    ##
    interval: 30s
    ## @param metrics.serviceMonitor.scrapeTimeout Specify the timeout after which the scrape is ended
    ## e.g:
    ## scrapeTimeout: 30s
    ##
    scrapeTimeout: ""
    ## @param metrics.serviceMonitor.relabelings RelabelConfigs to apply to samples before scraping
    ## ref: https://github.com/coreos/prometheus-operator/blob/master/Documentation/api.md#relabelconfig
    ##
    relabelings: []
    ## @param metrics.serviceMonitor.metricRelabelings MetricRelabelConfigs to apply to samples before ingestion
    ## ref: https://github.com/coreos/prometheus-operator/blob/master/Documentation/api.md#relabelconfig
    ##
    metricRelabelings: []
    ## @param metrics.serviceMonitor.honorLabels honorLabels chooses the metric's labels on collisions with target labels
    ##
    honorLabels: false
    ## @param metrics.serviceMonitor.selector ServiceMonitor selector labels
    ## ref: https://github.com/bitnami/charts/tree/main/bitnami/prometheus-operator#prometheus-configuration
    ##
    ## selector:
    ##   prometheus: my-prometheus
    ##
    selector: {}
    ## @param metrics.serviceMonitor.labels Extra labels for the ServiceMonitor
    ##
    labels: {}
  ## Prometheus Pod Monitor
  ## ref: https://github.com/coreos/prometheus-operator
  ##      https://github.com/coreos/prometheus-operator/blob/master/Documentation/api.md#podmonitor
  ##
  podMonitor:
    ## @param metrics.podMonitor.enabled Create PodMonitor resource(s) for scraping metrics using PrometheusOperator
    ##
    enabled: true
    ## @param metrics.podMonitor.port the pod port to scrape metrics from
    ##
    port: http-envoy-prom
    ## @param metrics.podMonitor.path the pod path to scrape metrics from
    ##
    path: /stats/prometheus
    ## @param metrics.podMonitor.namespace The namespace in which the PodMonitor will be created
    ##
    namespace: ""
    ## @param metrics.podMonitor.jobLabel The name of the label on the target pod to use as the job name in prometheus.
    ##
    jobLabel: envoy-stats
    ## @param metrics.podMonitor.interval The interval at which metrics should be scraped
    ##
    interval: 30s
    ## @param metrics.podMonitor.scrapeTimeout The timeout after which the scrape is ended
    ##
    scrapeTimeout: ""
    ## @param metrics.podMonitor.relabelings Metrics RelabelConfigs to apply to samples before scraping.
    ##
    relabelings: []
    ## @skip metrics.podMonitor.relabellings DEPRECATED: Use `metrics.podMonitor.relabelings` instead.
    ##
    relabellings: []
    ## @param metrics.podMonitor.metricRelabelings Metrics RelabelConfigs to apply to samples before ingestion.
    ##
    metricRelabelings: []
    # - targetLabel: "app"
    #   replacement: "redis"
    ## @param metrics.podMonitor.honorLabels Specify honorLabels parameter to add the scrape endpoint
    ##
    honorLabels: false
    ## @param metrics.podMonitor.labels Additional labels that can be used so PodMonitor resource(s) can be discovered by Prometheus
    ##
    labels: {}
    ## @param metrics.podMonitor.podTargetLabels Labels from the Kubernetes pod to be transferred to the created metrics
    ##
    podTargetLabels: []
    ## @param metrics.podMonitor.sampleLimit Limit of how many samples should be scraped from every Pod
    ##
    sampleLimit: false
    ## @param metrics.podMonitor.targetLimit Limit of how many targets should be scraped
    ##
    targetLimit: false
    ## @param metrics.podMonitor.additionalEndpoints  Additional endpoints to scrape (e.g sentinel)
    ##
    additionalEndpoints: []
    # - interval: "30s"
    #   path: "/scrape"
    #   port: "metrics"
    #   params:
    #     target: ["localhost:26379"]
    #   metricRelabelings:
    #     - targetLabel: "app"
    #       replacement: "sentinel"
  ## Prometheus Operator PrometheusRule configuration
  ##
  prometheusRule:
    ## @param metrics.prometheusRule.enabled if `true`, creates a Prometheus Operator PrometheusRule (also requires `metrics.enabled` to be `true` and `metrics.prometheusRule.rules`)
    ##
    enabled: false
    ## @param metrics.prometheusRule.namespace Namespace for the PrometheusRule Resource (defaults to the Release Namespace)
    ##
    namespace: ""
    ## @param metrics.prometheusRule.additionalLabels Additional labels that can be used so PrometheusRule will be discovered by Prometheus
    ##
    additionalLabels: {}
    ## @param metrics.prometheusRule.rules Prometheus Rule definitions
    ##  - alert: MariaDB-Down
    ##    expr: absent(up{job="mariadb"} == 1)
    ##    for: 5m
    ##    labels:
    ##      severity: warning
    ##      service: mariadb
    ##    annotations:
    ##      message: 'Istio Gateway instance {{ `{{` }} $labels.instance {{ `}}` }} is down'
    ##      summary: Istio Gateway instance is down
    ##
    rules: []

## @section Istio Gateway parameters
##

gateways:
  - enabled: false
    ## @param gateways.$gateway.name Unique label for the gateway. This is required to ensure Gateways can select this workload
    ##
    name: ingressgateway
    ## @param gateways.$gateway.revision Revision is set as 'version' label and part of the resource names when installing multiple control planes.
    ##
    revision: ""
    ## @param gateways.$gateway.replicaCount Number of Istio Gateway replicas
    ##
    replicaCount: 1
    ## @param gateways.$gateway.image.registry Proxy image registry
    ## @param gateways.$gateway.image.repository Proxy image repository
    ## @param gateways.$gateway.image.tag Proxy image tag (immutable tags are recommended)
    ## @param gateways.$gateway.image.digest Proxy image digest in the way sha256:aa.... Please note this parameter, if set, will override the tag
    ## @param gateways.$gateway.image.pullPolicy Proxy image pull policy
    ## @param gateways.$gateway.image.pullSecrets Proxy image pull secrets
    ## @param gateways.$gateway.image.debug Proxy image debug mode
    ##
    image:
      registry: ""
      repository: ""
      tag: ""
      digest: ""
      ## Specify a imagePullPolicy
      ## Defaults to 'Always' if image tag is 'latest', else set to 'IfNotPresent'
      ## ref: https://kubernetes.io/docs/user-guide/images/#pre-pulling-images
      ##
      pullPolicy: IfNotPresent
      ## Optionally specify an array of imagePullSecrets.
      ## Secrets must be manually created in the namespace.
      ## ref: https://kubernetes.io/docs/tasks/configure-pod-container/pull-image-private-registry/
      ## E.g:
      ## pullSecrets:
      ##  - myRegistryKeySecretName
      ##
      pullSecrets: []
      ## Set to true if you would like to see extra information on logs
      ##
      debug: false

    ## @section Traffic Exposure Parameters

    ## Kubernetes Gateway API parameters
    ## ref: https://gateway-api.sigs.k8s.io/

    gatewayApi:
      ## @param gateways.$gateway.gatewayApi.create Create Kubernetes Gateway API
      ##
      create: true
      ## @param gateways.$gateway.gatewayApi.annotations  Annotations that SHOULD be applied to any resources created in response to this Gateway.
      ## ref: https://gateway-api.sigs.k8s.io/reference/spec/#gateway.networking.k8s.io/v1.GatewayInfrastructure
      ##
      annotations: {}
      ## @param gateways.$gateway.gatewayApi.labels  Labels that SHOULD be applied to any resources created in response to this Gateway.
      ## ref: https://gateway-api.sigs.k8s.io/reference/spec/#gateway.networking.k8s.io/v1.GatewayInfrastructure
      ##
      labels: {}
      ## @param gateways.$gateway.gatewayApi.parametersRef  ParametersRef is a reference to a resource that contains the configuration
      ## parameters corresponding to the Gateway. This is optional if the controller does not require any additional configuration.
      ## ref: https://gateway-api.sigs.k8s.io/reference/spec/#gateway.networking.k8s.io/v1.GatewayInfrastructure
      ##
      parametersRef: {}
      ## @param gateways.$gateway.gatewayApi.backendTLS  BackendTLS configures TLS settings for when this Gateway is connecting to backends with TLS.
      ##
      backendTLS:
        clientCertificateRef: 
          kind: Secret
          name: ""
          namespace: ""
      ## @param gateways.$gateway.gatewayApi.allowedListeners  AllowedListeners defines which ListenerSets can be attached to this Gateway. While
      ## this feature is experimental, the default value is to allow no ListenerSets.
      ##
      allowedListeners: {}
      ## @param gateways.$gateway.gatewayApi.listeners Listeners associated with this Gateway. Listeners define logical endpoints that are
      ## bound on this Gateway’s addresses. At least one Listener MUST be specified.
      ##
      listeners: []
      ## @param gateways.$gateway.gatewayApi.extraListeners  Extra listeners associated with this Gateway. Listeners define logical endpoints
      ## that are bound on this Gateway’s addresses.
      ##
      extraListeners: []

    ## Istio Ingress Gateway service parameters
    ##
    service:
      ## @param gateways.$gateway.service.type Istio Ingress Gateway Kubernetes service type
      ##
      type: LoadBalancer
      ## @param gateways.$gateway.service.ports.status-port Istio Ingress Gateway Kubernetes Status port
      ## @param gateways.$gateway.service.ports.http2 Istio Ingress Gateway Kubernetes HTTP/2 port
      ## @param gateways.$gateway.service.ports.https Istio Ingress Gateway Kubernetes HTTPS port
      ##
      ## You can add custom gateway ports in user values overrides, but it must include those ports since helm replaces.
      ## Note that AWS ELB will by default perform health checks on the first port
      ## on this list. Setting this to the health check port will ensure that health
      ## checks always work. https://github.com/istio/istio/issues/12503
      ##
      ports:
        status: 15021
        http2: 80
        https: 443
      ## @param service.nodePorts.http Istio Ingress Gateway Kubernetes service node port
      ## ref: https://kubernetes.io/docs/concepts/services-networking/service/#type-nodeport
      ##
      nodePorts:
        status: ""
        http2: ""
        https: ""
        metrics: ""
      ## @param service.clusterIP Istio Ingress Gateway Kubernetes service clusterIP IP
      ##
      clusterIP: ""
      ## @param service.loadBalancerIP Istio Ingress Gateway loadBalancerIP if service type is `LoadBalancer`
      ## ref: https://kubernetes.io/docs/concepts/services-networking/service/#internal-load-balancer
      ##
      loadBalancerIP: ""
      ## @param service.ipFamilyPolicy Istio Gateway Kubernetes service ipFamilyPolicy policy
      ##
      ipFamilyPolicy: SingleStack
      ## @param service.externalTrafficPolicy Enable client source IP preservation
      ## ref https://kubernetes.io/docs/tasks/access-application-cluster/create-external-load-balancer/#preserving-the-client-source-ip
      ##
      externalTrafficPolicy: Cluster
      ## @param service.allocateLoadBalancerNodePorts Allow users to disable node ports for Service Type=LoadBalancer. This is useful for 
      ## bare metal / on-prem environments that rely on VIP based LB implementations.
      ## ref https://kubernetes.io/docs/concepts/services-networking/service/#load-balancer-nodeport-allocation
      ##
      allocateLoadBalancerNodePorts: "false"
      ## @param service.loadBalancerClass Enables to use a load balancer implementation other than the cloud provider default.
      ## https://kubernetes.io/docs/concepts/services-networking/service/#load-balancer-class
      ##
      loadBalancerClass: ""
      ## @param service.loadBalancerSourceRanges Address that are allowed when Istio Ingress Gateway service is LoadBalancer
      ## https://kubernetes.io/docs/tasks/access-application-cluster/configure-cloud-provider-firewall/#restrict-access-for-loadbalancer-service
      ## E.g.
      ## loadBalancerSourceRanges:
      ##   - 10.10.10.0/24
      ##
      loadBalancerSourceRanges: []
      ## @param service.extraPorts Extra ports to expose (normally used with the `sidecar` value)
      ##
      extraPorts: []
      ## @param service.annotations Provide any additional annotations which may be required
      ##
      annotations: {}
      ## @param service.sessionAffinity Session Affinity for Kubernetes service, can be "None" or "ClientIP"
      ## If "ClientIP", consecutive client requests will be directed to the same Pod
      ## ref: https://kubernetes.io/docs/concepts/services-networking/service/#virtual-ips-and-service-proxies
      ##
      sessionAffinity: None
      ## @param service.sessionAffinityConfig Additional settings for the sessionAffinity
      ## sessionAffinityConfig:
      ##   clientIP:
      ##     timeoutSeconds: 300
      sessionAffinityConfig: {}

    ## @param gateways.$gateway.containerPorts.http Istio Gateway HTTP container port
    ##
    containerPorts:
      status: 15021
      http2: 80
      https: 443
      metrics: 15090
      metricsMerge: 15020
    ## Istio Gateway Pod security context
    ## ref: https://kubernetes.io/docs/tasks/configure-pod-container/security-context/#set-the-security-context-for-a-pod
    ## @param podSecurityContext.enabled Enable security context for Istio Gateway pods
    ## @param podSecurityContext.fsGroup Group ID for the mounted volumes' filesystem
    ##
    podSecurityContext:
      enabled: false
      # sysctls:
      #   - name: net.ipv4.ip_unprivileged_port_start
      #     value: "0"
      # fsGroup: 101
      # runAsUser: 101
    ## Istio Gateway container security context
    ## ref: https://kubernetes.io/docs/tasks/configure-pod-container/security-context/#set-the-security-context-for-a-container
    ## @param containerSecurityContext.enabled Istio Gateway container securityContext
    ## @param containerSecurityContext.runAsUser User ID for the Istio Gateway container
    ## @param containerSecurityContext.runAsNonRoot Set Controller container's Security Context runAsNonRoot
    ##
    containerSecurityContext:
      enabled: false
      # allowPrivilegeEscalation: false
      # capabilities:
      #   drop:
      #     - ALL
      # privileged: false
      # readOnlyRootFilesystem: true
      # runAsGroup: 1337
      # runAsUser: 1337
      # runAsNonRoot: true

    ## Resource requests and limits
    ## ref: https://kubernetes.io/docs/concepts/configuration/manage-compute-resources-container/
    ## We usually recommend not to specify default resources and to leave this as a conscious
    ## choice for the user. This also increases chances charts run on environments with little
    ## resources, such as Minikube. If you do want to specify resources, uncomment the following
    ## lines, adjust them as necessary, and remove the curly braces after 'resources:'.
    ## @param resourcesPreset Set container resources according to one common preset (allowed values: none, nano, micro, small, medium, large, xlarge, 2xlarge). This is ignored if resources is set (resources is recommended for production).
    ## More information: https://github.com/bitnami/charts/blob/main/bitnami/common/templates/_resources.tpl#L15
    ##
    resourcesPreset: "nano"
    ## @param resources Set container requests and limits for different resources like CPU or memory (essential for production workloads)
    ## Example:
    ## resources:
    ##   requests:
    ##     cpu: 2
    ##     memory: 512Mi
    ##   limits:
    ##     cpu: 3
    ##     memory: 1024Mi
    ##
    resources: {}

    ## Configure extra options for Istio Gateway containers' liveness, readiness and startup probes
    ## ref: https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/#configure-probes)
    ## @param startupProbe.enabled Enable startupProbe
    ## @param startupProbe.initialDelaySeconds Initial delay seconds for startupProbe
    ## @param startupProbe.periodSeconds Period seconds for startupProbe
    ## @param startupProbe.timeoutSeconds Timeout seconds for startupProbe
    ## @param startupProbe.failureThreshold Failure threshold for startupProbe
    ## @param startupProbe.successThreshold Success threshold for startupProbe
    ##
    startupProbe:
      enabled: false
      failureThreshold: 30
      httpGet:
        path: /healthz/ready
        port: 15021
        scheme: HTTP
      initialDelaySeconds: 1
      timeoutSeconds: 1
      periodSeconds: 1
      successThreshold: 1
    ## Configure extra options for liveness probe
    ## ref: https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/#configure-probes
    ## @param livenessProbe.enabled Enable livenessProbe
    ## @param livenessProbe.initialDelaySeconds Initial delay seconds for livenessProbe
    ## @param livenessProbe.periodSeconds Period seconds for livenessProbe
    ## @param livenessProbe.timeoutSeconds Timeout seconds for livenessProbe
    ## @param livenessProbe.failureThreshold Failure threshold for livenessProbe
    ## @param livenessProbe.successThreshold Success threshold for livenessProbe
    ##
    livenessProbe:
      enabled: false
      initialDelaySeconds: 120
      periodSeconds: 60
      timeoutSeconds: 2
      failureThreshold: 4
      successThreshold: 1
    ## @param readinessProbe.enabled Enable readinessProbe
    ## @param readinessProbe.initialDelaySeconds Initial delay seconds for readinessProbe
    ## @param readinessProbe.periodSeconds Period seconds for readinessProbe
    ## @param readinessProbe.timeoutSeconds Timeout seconds for readinessProbe
    ## @param readinessProbe.failureThreshold Failure threshold for readinessProbe
    ## @param readinessProbe.successThreshold Success threshold for readinessProbe
    ##
    readinessProbe:
      enabled: false
      failureThreshold: 30
      httpGet:
        path: /healthz/ready
        port: 15021
        scheme: HTTP
      initialDelaySeconds: 1
      periodSeconds: 15
      timeoutSeconds: 1
      successThreshold: 1
    ## @param customStartupProbe Override default startup probe for Istio Gateway containers
    ##
    customStartupProbe: {}
    ## @param customLivenessProbe Override default liveness probe for Istio Gateway containers
    ##
    customLivenessProbe: {}
    ## @param customReadinessProbe Override default readiness probe for Istio Gateway containers
    ##
    customReadinessProbe: {}
    ## @param startupWaitOptions Override default builtin startup wait check options for Istio Gateway containers
    ## Example (with default options):
    ## startupWaitOptions:
    ##   retries: 300
    ##   waitTime: 2
    ##
    startupWaitOptions: {}
    ## @param extraFlags Istio Gateway additional command line flags
    ## Can be used to specify command line flags, for example:
    ## E.g.
    ## extraFlags: "--max-connect-errors=1000 --max_connections=155"
    ##
    extraFlags: ""
    ## @param extraEnvVars Extra environment variables to be set on Istio Gateway containers
    ## E.g.
    ## extraEnvVars:
    ##  - name: TZ
    ##    value: "Europe/Paris"
    ##
    extraEnvVars: []
    ## @param extraEnvVarsCM Name of existing ConfigMap containing extra env vars for Istio Gateway containers
    ##
    extraEnvVarsCM: ""
    extraEnvVarsCMs: []
    ## @param extraEnvVarsSecret Name of existing Secret containing extra env vars for Istio Gateway containers
    ##
    extraEnvVarsSecret: ""
    extraEnvVarsSecrets: []
    ## @param primary.extraVolumes Optionally specify extra list of additional volumes to the MariaDB Primary pod(s)
    ##
    extraVolumes: []
    ## @param primary.extraVolumeMounts Optionally specify extra list of additional volumeMounts for the MariaDB Primary container(s)
    ##
    extraVolumeMounts: []
    ## @param primary.initContainers Add additional init containers for the MariaDB Primary pod(s)
    ##
    initContainers: []
    ## @param primary.sidecars Add additional sidecar containers for the MariaDB Primary pod(s)
    ##
    sidecars: []

    ## @param gateways.$gateway.updateStrategy.type Istio Gateway statefulset strategy type
    ## ref: https://kubernetes.io/docs/concepts/workloads/controllers/statefulset/#update-strategies
    ##
    updateStrategy:
      ## StrategyType
      ## Can be set to RollingUpdate or OnDelete
      ##
      type: RollingUpdate
    ## @param gateways.$gateway.rollingUpdatePartition Partition update strategy for Istio Gateway statefulset
    ## https://kubernetes.io/docs/concepts/workloads/controllers/statefulset/#partitions
    ##
    rollingUpdatePartition: ""
    ## @param gateways.$gateway.podAnnotations Additional pod annotations for Istio Gateway pods
    ## ref: https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/
    ##
    podAnnotations: {}
    ## @param gateways.$gateway.podLabels Extra labels for Istio Gateway pods
    ## ref: https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/
    ##
    podLabels: {}
    ## @param gateways.$gateway.podAffinityPreset Pod affinity preset. Ignored if `gateways.$gateway.affinity` is set. Allowed values: `soft` or `hard`
    ## ref: https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#inter-pod-affinity-and-anti-affinity
    ##
    podAffinityPreset: ""
    ## @param gateways.$gateway.podAntiAffinityPreset Pod anti-affinity preset. Ignored if `gateways.$gateway.affinity` is set. Allowed values: `soft` or `hard`
    ## Ref: https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#inter-pod-affinity-and-anti-affinity
    ##
    podAntiAffinityPreset: soft
    ## Node affinity preset
    ## Ref: https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#node-affinity
    ## @param gateways.$gateway.nodeAffinityPreset.type Node affinity preset type. Ignored if `gateways.$gateway.affinity` is set. Allowed values: `soft` or `hard`
    ## @param gateways.$gateway.nodeAffinityPreset.key Node label key to match. Ignored if `gateways.$gateway.affinity` is set
    ## @param gateways.$gateway.nodeAffinityPreset.values Node label values to match. Ignored if `gateways.$gateway.affinity` is set
    ##
    nodeAffinityPreset:
      ## @param gateways.$gateway.nodeAffinityPreset.type Istio Gateway node affinity preset type. Ignored if `gateways.$gateway.affinity` is set. Allowed values: `soft` or `hard`
      ##
      type: ""
      ## @param gateways.$gateway.nodeAffinityPreset.key Istio Gateway node label key to match Ignored if `gateways.$gateway.affinity` is set.
      ## E.g.
      ## key: "kubernetes.io/e2e-az-name"
      ##
      key: ""
      ## @param gateways.$gateway.nodeAffinityPreset.values Istio Gateway node label values to match. Ignored if `gateways.$gateway.affinity` is set.
      ## E.g.
      ## values:
      ##   - e2e-az1
      ##   - e2e-az2
      ##
      values: []
    ## @param gateways.$gateway.affinity Affinity for Istio Gateway pods assignment
    ## Ref: https://kubernetes.io/docs/concepts/configuration/assign-pod-node/#affinity-and-anti-affinity
    ## Note: podAffinityPreset, podAntiAffinityPreset, and  nodeAffinityPreset will be ignored when it's set
    ##
    affinity: {}
    ## @param gateways.$gateway.nodeSelector Node labels for Istio Gateway pods assignment
    ## Ref: https://kubernetes.io/docs/user-guide/node-selection/
    ##
    nodeSelector: {}
    ## @param gateways.$gateway.tolerations Tolerations for Istio Gateway pods assignment
    ## Ref: https://kubernetes.io/docs/concepts/configuration/taint-and-toleration/
    ##
    tolerations: []
    ## @param gateways.$gateway.topologySpreadConstraints Topology Spread Constraints for Istio Gateway pods assignment
    ## ref: https://kubernetes.io/docs/concepts/workloads/pods/pod-topology-spread-constraints/
    ## E.g.
    ## topologySpreadConstraints:
    ##   - maxSkew: 1
    ##     topologyKey: topology.kubernetes.io/zone
    ##     whenUnsatisfiable: DoNotSchedule
    ##
    topologySpreadConstraints: {}
    ## @param gateways.$gateway.priorityClassName Priority class for Istio Gateway pods assignment
    ## Ref: https://kubernetes.io/docs/concepts/configuration/pod-priority-preemption/
    ##
    priorityClassName: ""
    ## @param gateways.$gateway.runtimeClassName Runtime Class for Istio Gateway pods
    ## Ref: https://kubernetes.io/docs/concepts/containers/runtime-class/
    ##
    runtimeClassName: ""

    ## @param gateways.$gateway.networkGateway If specified, the gateway will act as a network gateway for the given network.
    ##
    networkGateway: false

    ##############
    secretVolumes:
      - name: ingressgateway-certs
        secretName: istio-ingressgateway-certs
        mountPath: /etc/istio/ingressgateway-certs
      - name: ingressgateway-ca-certs
        secretName: istio-ingressgateway-ca-certs
        mountPath: /etc/istio/ingressgateway-ca-certs

    ## Specifies whether a ServiceAccount should be created
    ##
    serviceAccount:
      ## @param gateways.$gateway.serviceAccount.create Enable the creation of a ServiceAccount for Istio Gateway pods
      ##
      create: true
      ## @param gateways.$gateway.serviceAccount.name Name of the created ServiceAccount
      ## If not set and create is true, a name is generated using the fullname template
      ##
      name: ""
      ## @param gateways.$gateway.serviceAccount.automountServiceAccountToken Auto-mount the service account token in the pod
      ##
      automountServiceAccountToken: false
      ## @param gateways.$gateway.serviceAccount.annotations Additional custom annotations for the ServiceAccount
      ##
      annotations: {}
    ## Role Based Access Configuration
    ## Ref: https://kubernetes.io/docs/admin/authorization/rbac/
    ##
    rbac:
      ## @param gateways.$gateway.rbac.create Specify whether RBAC resources should be created and used
      ##
      create: true
      ## @param gateways.$gateway.rbac.rules Custom RBAC rules
      ## Example:
      ## rules:
      ##   - apiGroups:
      ##       - ""
      ##     resources:
      ##       - pods
      ##     verbs:
      ##       - get
      ##       - list
      ##
      rules: []

## @section Istio Telemetry parameters
## Telemetry defines how the telemetry is generated for workloads within a mesh.
##

telemetry:
  enabled: false
  ## @param telemetry.accessLogging  Configures the access logging behavior for all selected workloads.
  ## ref: https://preliminary.istio.io/latest/docs/reference/config/telemetry/#AccessLogging
  ##
  accessLogging: []
  ## @param telemetry.metrics  Configures the metrics behavior for all selected workloads.
  ##
  metrics: []
  ## @param telemetry.selector  The selector decides where to apply the policy. If not set, the policy will be applied 
  ## to all workloads in the same namespace as the policy.
  ##
  selector: []
  ## @param telemetry.targetRefs  Specifies a list of resources the policy should be applied to. The targeted resources
  ## specified will determine which workloads the policy applies to.
  ##
  targetRefs: []
  ## @param telemetry.tracing   Configures the tracing behavior for all selected workloads.
  ##
  tracing: []